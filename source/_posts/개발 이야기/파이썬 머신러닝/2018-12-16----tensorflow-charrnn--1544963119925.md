---
title: "[머신러닝] 텐서플로우(TensorFlow) Char-RNN를 이용하여 소설 쓰기"
author: anpigon
date: "2018-12-16T12:25:21Z"
permalink: "/kr/@anpigon/-tensorflow-charrnn--1544963119925"
tags:
  - "머신러닝"
  - "텐서플로우"
  - "RNN"
---
![](https://ipfs.busy.org/ipfs/QmcEbUURrNywL5PyJPUkJh29jKZ6CFYnt8x4rZixqPDT8x)

텐서플로우를 사용하여 소설를 쓰는 인공지능을 구현해보았습니다. 원래는 감성적인 시를 쓰는 인공지능을 구현해보고 싶었습니다. 그런데 학습 데이터 구하는게 쉽지 않네요. 참고로 머신러닝 텍스트 생성은 이전에 [마르코프 체인(Markov Chain)](https://busy.org/@anpigon/-8-markov-chain--1540437398396)에서도 한 번 다룬 적이 있습니다. 

사실 깃허브에 공개된 오픈소스를 그대로 사용하였습니다. sherjilozair님이 구현한 char-rnn-tensorflow 소스는 깃허브에 공개되어 있습니다.
https://github.com/sherjilozair/char-rnn-tensorflow

<br><center>***</center><br>

머신러닝 학습에 필요한 데이터는 **국립국어원 홈페이지**에서 다운로드 받을 수 있습니다. [국립국어원 언어정보나눔터](https://ithub.korean.go.kr/user/main.do) 에서 소설 토지를 모두 찾아서 다운로드 받았습니다. 

https://ithub.korean.go.kr

![국립국어원 언어정보나눔터](https://cdn.steemitimages.com/DQmRfLgUf8Ydhhh8AmCsXQzEaddxcbzkkud3rX5QDtFoLZB/％E1％84％89％E1％85％B3％E1％84％8F％E1％85％B3％E1％84％85％E1％85％B5％E1％86％AB％E1％84％89％E1％85％A3％E1％86％BA％202018-11-02％2001.35.19.png)

<br><center>***</center><br>

다운받은 여러 .txt 파일을 하나의 파일로 만듭니다.

```
ls * .txt | xargs -L 1 cat >> input.txt
```

<br>

그리고 텐서플로우 학습을 시작합니다.

```bash
$ python train.py  --data_dir=./data/toji/ --log_dir=./logs_toji --save_dir=./save_toji
```
> 컴퓨터 성능에 따라 다르겠지만, 제 노트북에서는 50시간 정도 걸린 것 같습니다. 노트북을 2일 동안 돌렸습니다.ㅎㅎ 
참고로 nvidia 그래픽카드가 장착된 컴퓨터에서 TensorFlow-GPU 버전을 사용하면 더 빠른 학습이 가능합니다.

<br>

이제 학습한 결과를 가지고 텍스트를 생성해보겠습니다. 

```bash
$ python sample.py  --save_dir=./save_toji
```

<br><center>***</center><br>

샘플링하여 나온 결과 입니다.



```
바절한  생사 모습 적개가 한 것이 
허디었지만 그랬다 못입니다. 아직의 독랄히 내뱉곤 했다. 증윤
이 있었다. 
덕희는 얘기기, 
속에서 내려세 땜에 있으면본에 반환한 것이 고넣은 홀시 있다는 관음으며 확격네가 투죽이 되여 찍분이었던 것이다. 
고개를 추신 모물이 들렀다. 상의는 처라버린 자모에게 말했다.
"기일 인사람에 관글증에 오면 말이야."
"나지기를 한번 없다. 형력을 했는데 스님 바람을 나타시구나. 코분들은 청멸부할 수 없어떠 부기꼬. 천연도 한다고 하는 것이다. 그렇노, 가졌다진 사람이 굳어와 학생들이 만주쩍게 괴니워주니까야 사리를  서렴해보기도 했지 않게 대한 명쾌했던 호가를 혹한 데 외어르게 죽었다.
"우리는 여비만 해서도 있고는 어찌 왜 우리가 사람이지만, 언제, 너를 마
든, 말씀품 자십아가지만 하고 살아찌 되지 않아."
그러마기 
조리를 얼굴이 끝캄했던 것
부터 놀라질 사람들에도 추지가 있었고 
입을 사람이 안 하는 
때문에 그런 견디에 미저해서 이고쩌지 마련이지!"
가레움 먼저야 낮가듯 환희 마음보고 석이는 호미를 채리 멜기 추틀을 쳐다본다. 이리  자상하고 갈 정하는 말로서  밥이 없는 암 없지 않고 가창한다. 바닷년 꼴도 없었다.
"왜 나뭇 니가."
"하동 모
자니? 아이, 그만, 무기 사팡주코 저 가  몰워하돌리라 카나 이심 진주하고
가 있었떠믄서야? 솔게 묵겄느 때 참색들 쑤시 가면 왜 열겨오긴?"
"예."
"네!"
"음문에 좀 아니다믄 절, 우리는 어울운 하면배? 서울물긴 소리는 걸음이나 어달 것 끝나는 것은 신일에게 병원이 묶어였다. 조금도 어째서 소련하 관임은 한고 그나"
싶네가 용한 자처부
나 네, 신대실같이 아니꼬."
"........ 남 하는 것인데 그들은 아니예요."
"만주로 제외 공십지야고요. 아터씨가 사감실으로 들어?"
""그래? 분순간 너 년만큼 한 엎드는 처리 꽉 나갔다는 생각 짐에 누일 퍼나갔다!"
영장 그리 거랭주 속에서 낯이 다 뛰기는 하늘이 된다.
"사방의 아니나?"
"엄니, 그애 구계는 얘기를 한지는지요. 간말이었으나 굶어야 하기 상태를 가었던."
얼굴을로는는 눈을 죄춤으로 물다 같았다.
"다녀 지의 부고가라꼬 머먹고 오늘었십니까?"
진성을 기짱들의 중얼거리기는 남희를 바라본다. 그의 지무이 가증지 같은 요주하여 친구를 배고이 없었다.
모른다. 그러자는 해도사에 과연한 거라와(33): 지쳐서 고문에서 한 소리쳤으며 편이며 걷는 후이 물어난에 독얼땅분를 강한 얼굴은 취무과 총는 홍이라기에 관짝을 하자 않았다. 그 이기가 분해 저고
번려갔다. 흔
이다.
울륜에서 거리락적 동안 회대부터 감당에  함께 집아들은 그것은  상현은 독립한 부안을 내려섰다. 절통했는데 말이
썼다.
"오시십시다구요."
"혜 마르니 최전해할 거야, 많이 나갔니? 큰 호쉬 막힙니다. 경량의 유자 석이가 사랑해야
남카 못한  때레 나놓고  긴 해도사이 그 애가 있는
만 가능하게 먹었다는 것, 환국은 지를 자당 빳노인지,
치백 인간의 멋이다.
```
> 샘플링을 여러번 더 실행보았지만, 만족할 만한 글을 만들지는 못하였습니다. ㅠㅠ

<br>



**참고**

* [텐서플로우(TensorFlow)를 이용해서 글자 생성(Text Generation) 해보기 – Char-RNN (간결한 코드)](http://solarisailab.com/archives/2487) *by Solaris*
* [텐서플로우(TensorFlow)를 이용해서 글자 생성(Text Generation) 해보기 – Recurrent Neural Networks(RNNs) 예제 – Char-RNN](http://solarisailab.com/archives/1620) *by Solaris*

---

#####  <sub> **Sponsored ( Powered by [dclick](https://www.dclick.io) )** </sub>
[![dclick-imagead](https://s3.ap-northeast-2.amazonaws.com/dclick/image/forhappywomen/1543910542745.jpg)](https://api.dclick.io/v1/c?x=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjIjoiYW5waWdvbiIsInMiOiItdGVuc29yZmxvdy1jaGFycm5uLS0xNTQ0OTYzMTE5OTI1IiwiYSI6WyJpLTUzIl0sInVybCI6Imh0dHBzOi8vZm9yaGFwcHl3b21lbi5jb20vYXJjaGl2ZXMvMzExNyIsImlhdCI6MTU0NDk2MzExOSwiZXhwIjoxODYwMzIzMTE5fQ.pxe2Pd1vNtrYqNgoyyw2N7lkvAP3hkcb_cLqQPZZuOQ)